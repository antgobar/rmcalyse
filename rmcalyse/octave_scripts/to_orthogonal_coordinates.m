%%%------------------------------------------------------------------------%%%%%% Program to convert atomic coordinates to orthonormal basis%%%%%%------------------------------------------------------------------------% Lattice parameters - unit cell length and angles% Non orthomormal basisnob = [4; 4; 4];a = nob(1);b = nob(2);c = nob(3);al = deg2rad(80);be = deg2rad(90);ga = deg2rad(90);p_prime1 = [0; 0; 0]p_prime2 = [1; 1; 1]% Atomic positionsV = a*b*c * (1 - cos(al)^2 - cos(be)^2 - cos(ga)^2 + 2*cos(al)*cos(be)*cos(ga))^0.5a1 = a;a2 = 0;a3 = 0;b1 = b * cos(ga);b2 = b * sin(ga);b3 = 0;c1 = c * cos(be);c2 = c * (cos(al) - (cos(be) * cos(ga))) / sin(ga);c3 = V / (a * b * sin(ga));A = [a1; a2; a3];B = [b1; b2; b3];C = [c1; c2; c3];M = [A, B, C]p1 = M * p_prime1p2 = M * p_prime2ob1 = p1 ./ nobob2 = p2 ./ nobdistance = (sum((p1-p2).^2))^0.5